{"openapi":"3.0.3","info":{"title":"Chess2","version":"0.1.0"},"paths":{"/auth/signup":{"post":{"tags":["auth"],"summary":"Signup","description":"Takes a username, email and password and creates registers a new user.\n\nThis path operation will also:\n- send a verification email\n- create the necessary files","operationId":"signup","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserIn"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserOutSensitive"}}}},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"409":{"description":"Username / email already taken","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_dict_str__str__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/login":{"post":{"tags":["auth"],"summary":"Login","description":"Authenticates a user by generating a jwt access and refresh token if the credentials match.","operationId":"login","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_auth-login"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthTokens"}}}},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/logout":{"post":{"tags":["auth"],"summary":"Logout","operationId":"logout","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}}}}},"/auth/refresh-access-token":{"get":{"tags":["auth"],"summary":"Refresh Access Token","description":"Generate a new access token using a refresh token","operationId":"refresh_access_token","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AccessToken"}}}},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}}},"security":[{"OAuth2PasswordBearerCookie":[]}]}},"/auth/guest-account":{"get":{"tags":["auth"],"summary":"Create Guest Account","description":"Create a new guest account and get its access token.\nKeep in mind the account is temporary and is bound to be deleted.","operationId":"create_guest_account","responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AccessToken"}}}},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}}}}},"/profile/{target}/info":{"get":{"tags":["profile"],"summary":"Get Info","description":"Fetch a user's profile","operationId":"get_info","security":[{"OAuth2PasswordBearerCookie":[]}],"parameters":[{"name":"target","in":"path","required":true,"schema":{"type":"string","title":"Target"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserOut"}}}},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"404":{"description":"Target user not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/profile/me/info-sensitive":{"get":{"tags":["profile"],"summary":"Get Info Sensitive","description":"Fetch the sensitive profile of user","operationId":"get_info_sensitive","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserOutSensitive"}}}},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}}},"security":[{"OAuth2PasswordBearerCookie":[]}]}},"/profile/{target}/games":{"get":{"tags":["profile"],"summary":"Paginate Games","description":"Paginate through game history for a specified target.\nRetrieve a paginated list of game results.","operationId":"paginate_games","security":[{"OAuth2PasswordBearerCookie":[]}],"parameters":[{"name":"target","in":"path","required":true,"schema":{"type":"string","title":"Target"}},{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Page"}},{"name":"per-page","in":"query","required":false,"schema":{"type":"integer","maximum":10,"exclusiveMinimum":0,"default":10,"title":"Per-Page"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/GameResults"},"title":"Response Profile-Paginate Games"}}}},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"404":{"description":"Target user not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/profile/{target}/total-game-count":{"get":{"tags":["profile"],"summary":"Total Game Count","description":"Count how many games a user has","operationId":"total_game_count","security":[{"OAuth2PasswordBearerCookie":[]}],"parameters":[{"name":"target","in":"path","required":true,"schema":{"type":"string","title":"Target"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"integer","title":"Response Profile-Total Game Count"}}}},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"404":{"description":"Target user not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/profile/{target}/ratings":{"get":{"tags":["profile"],"summary":"Get Ratings","description":"Get the current ratings of a user.\nIf a user is unrated in a certain variant, that variant will not be returned.","operationId":"get_ratings","security":[{"OAuth2PasswordBearerCookie":[]}],"parameters":[{"name":"target","in":"path","required":true,"schema":{"type":"string","title":"Target"}},{"name":"variants","in":"query","required":false,"schema":{"type":"array","items":{"$ref":"#/components/schemas/Variant"},"default":["fog of war","anarchy","chss"],"title":"Variants"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/Rating"},"title":"Response Profile-Get Ratings"}}}},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"404":{"description":"Target user not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/profile/{target}/rating-history":{"get":{"tags":["profile"],"summary":"Get Ratings History","description":"Get the rating history of a user.\nIf a user is unrated in a certain variant, that variant will not be returned.","operationId":"get_ratings_history","security":[{"OAuth2PasswordBearerCookie":[]}],"parameters":[{"name":"target","in":"path","required":true,"schema":{"type":"string","title":"Target"}},{"name":"since","in":"query","required":true,"schema":{"type":"string","format":"date","title":"Since"}},{"name":"variants","in":"query","required":false,"schema":{"type":"array","items":{"$ref":"#/components/schemas/Variant"},"default":["fog of war","anarchy","chss"],"title":"Variants"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#/components/schemas/RatingOverview"},{"type":"null"}]},"title":"Response Profile-Get Ratings History"}}}},"400":{"description":"Bad 'since' value","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_dict_str__str__"}}}},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"404":{"description":"Target user not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/profile/{target}/profile-picture":{"get":{"tags":["profile"],"summary":"Profile Picture","description":"Get a user's profile picture.\nIf the user hasn't uploaded a picture yet, the default one will be returned.","operationId":"profile_picture","security":[{"OAuth2PasswordBearerCookie":[]}],"parameters":[{"name":"target","in":"path","required":true,"schema":{"type":"string","title":"Target"}}],"responses":{"200":{"description":"Successful Response","content":{"image/webp":{}}},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/settings/profile":{"patch":{"tags":["settings"],"summary":"Update Profile","operationId":"update_profile","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BaseUserProfile"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserOut"}}}},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearerCookie":[]}]}},"/settings/email":{"put":{"tags":["settings"],"summary":"Change Email","description":"Update the email and send an email verification.\nThis will also unverify the user email.\n\nRequires a fresh JWT token.","operationId":"change_email","requestBody":{"content":{"application/json":{"schema":{"type":"string","format":"email","title":"New Email"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserOut"}}}},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"409":{"description":"Email taken","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearerCookie":[]}]}},"/settings/password":{"put":{"tags":["settings"],"summary":"Change Password","description":"Hash the password and update it. Requires a fresh JWT token.","operationId":"change_password","requestBody":{"content":{"application/json":{"schema":{"type":"string","title":"New Password"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserOut"}}}},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearerCookie":[]}]}},"/settings/username":{"put":{"tags":["settings"],"summary":"Change Username","description":"Update the username","operationId":"change_username","requestBody":{"content":{"application/json":{"schema":{"type":"string","title":"New Username"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserOut"}}}},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"409":{"description":"Username taken","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}},"429":{"description":"Username changed too recently","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}}},"security":[{"OAuth2PasswordBearerCookie":[]}]}},"/settings/upload-profile-picture":{"put":{"tags":["settings"],"summary":"Upload Profile Picture","description":"Change a user's profile picture.\nThe picture must be < 1mb and a valid image.","operationId":"upload_profile_picture","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_settings-upload_profile_picture"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"400":{"description":"Bad image","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"413":{"description":"Profile picture too large","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearerCookie":[]}]}},"/game-requests/pool/join":{"post":{"tags":["game-requests"],"summary":"Start Pool Game","description":"Searches for a game request that fits the criterias.\nIf a game was not found, it will create a new game request with an unspecified recipient.","operationId":"start_pool_game","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GameSettings"}}},"required":true},"responses":{"200":{"description":"Game started","content":{"application/json":{"schema":{}}}},"201":{"description":"Entered the pool"},"401":{"description":"Could not verify credentials","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"409":{"description":"You already have an active game","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse_str_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearerCookie":[]}]}}},"components":{"schemas":{"AccessToken":{"properties":{"token_type":{"type":"string","title":"Token Type","default":"bearer"},"access_token":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"}},"type":"object","title":"AccessToken"},"AuthTokens":{"properties":{"token_type":{"type":"string","title":"Token Type","default":"bearer"},"access_token":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Access Token"},"refresh_token":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Refresh Token"}},"type":"object","title":"AuthTokens"},"BaseUserProfile":{"properties":{"country":{"anyOf":[{"type":"string","pattern":"^\\w{3}$"},{"type":"null"}],"title":"Country"},"about":{"type":"string","maxLength":300,"title":"About","default":""}},"type":"object","title":"BaseUserProfile"},"Body_auth-login":{"properties":{"grant_type":{"anyOf":[{"type":"string","pattern":"password"},{"type":"null"}],"title":"Grant Type"},"username":{"type":"string","title":"Username"},"password":{"type":"string","title":"Password"},"scope":{"type":"string","title":"Scope","default":""},"client_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Id"},"client_secret":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Secret"}},"type":"object","required":["username","password"],"title":"Body_auth-login"},"Body_settings-upload_profile_picture":{"properties":{"pfp":{"type":"string","format":"binary","title":"Pfp"}},"type":"object","required":["pfp"],"title":"Body_settings-upload_profile_picture"},"ErrorResponse_dict_str__str__":{"properties":{"details":{"additionalProperties":{"type":"string"},"type":"object","title":"Details"}},"type":"object","required":["details"],"title":"ErrorResponse[dict[str, str]]"},"ErrorResponse_str_":{"properties":{"details":{"type":"string","title":"Details"}},"type":"object","required":["details"],"title":"ErrorResponse[str]"},"GameResult":{"type":"string","enum":["white","black","draw"],"title":"GameResult"},"GameResults":{"properties":{"token":{"type":"string","maxLength":8,"title":"Token"},"user_white":{"anyOf":[{"$ref":"#/components/schemas/SimpleUserOut"},{"type":"null"}]},"user_black":{"anyOf":[{"$ref":"#/components/schemas/SimpleUserOut"},{"type":"null"}]},"results":{"$ref":"#/components/schemas/GameResult"},"variant":{"$ref":"#/components/schemas/Variant"},"time_control":{"type":"integer","title":"Time Control"},"increment":{"type":"integer","title":"Increment"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["token","user_white","user_black","results","variant","time_control","increment","created_at"],"title":"GameResults"},"GameSettings":{"properties":{"variant":{"$ref":"#/components/schemas/Variant"},"time_control":{"type":"integer","title":"Time Control"},"increment":{"type":"integer","title":"Increment"}},"type":"object","required":["variant","time_control","increment"],"title":"GameSettings"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"Rating":{"properties":{"elo":{"type":"integer","title":"Elo"},"achieved_at":{"type":"string","format":"date-time","title":"Achieved At"}},"type":"object","required":["elo","achieved_at"],"title":"Rating"},"RatingOverview":{"properties":{"min":{"type":"integer","title":"Min"},"max":{"type":"integer","title":"Max"},"current":{"type":"integer","title":"Current"},"history":{"items":{"$ref":"#/components/schemas/Rating"},"type":"array","title":"History"}},"type":"object","required":["min","max","current","history"],"title":"RatingOverview"},"SimpleUserOut":{"properties":{"user_id":{"type":"integer","title":"User Id"},"username":{"type":"string","title":"Username"}},"type":"object","required":["user_id","username"],"title":"SimpleUserOut"},"UserIn":{"properties":{"username":{"type":"string","maxLength":30,"minLength":3,"title":"Username"},"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","title":"Password"}},"type":"object","required":["username","email","password"],"title":"UserIn"},"UserOut":{"properties":{"username":{"type":"string","maxLength":30,"minLength":3,"title":"Username"},"country":{"anyOf":[{"type":"string","pattern":"^\\w{3}$"},{"type":"null"}],"title":"Country"},"about":{"type":"string","maxLength":300,"title":"About","default":""},"user_id":{"type":"integer","title":"User Id"},"pfp_last_changed":{"type":"string","format":"date-time","title":"Pfp Last Changed"}},"type":"object","required":["username","user_id"],"title":"UserOut"},"UserOutSensitive":{"properties":{"username":{"type":"string","maxLength":30,"minLength":3,"title":"Username"},"email":{"type":"string","format":"email","title":"Email"},"country":{"anyOf":[{"type":"string","pattern":"^\\w{3}$"},{"type":"null"}],"title":"Country"},"about":{"type":"string","maxLength":300,"title":"About","default":""},"user_id":{"type":"integer","title":"User Id"},"pfp_last_changed":{"type":"string","format":"date-time","title":"Pfp Last Changed"}},"type":"object","required":["username","email","user_id"],"title":"UserOutSensitive"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"Variant":{"type":"string","enum":["fog of war","anarchy","chss"],"title":"Variant"}},"securitySchemes":{"OAuth2PasswordBearerCookie":{"type":"oauth2","flows":{"password":{"scopes":{},"tokenUrl":"auth/login"}}}}}}